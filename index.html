<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japon : L'Itin√©raire Ultime</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Zen Minimalist - Cream (#FAFAF9) background, Sumi Ink (#1C1917) text, Indigo (#4338CA) primary, Matcha (#65A30D) accent -->
    <!-- Application Structure Plan: 
         1. Dashboard: Global stats for 50+ locations.
         2. Region Logic: Grouped into major zones (Kanto, Kansai, Chugoku, Kyushu, Chubu, Tohoku).
         3. Hub Logic: Critical logic applied. E.g., 'Kyoto Sea' separated from 'Kyoto City' due to distance.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 500px;
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 antialiased selection:bg-indigo-100 selection:text-indigo-900">

    <!-- Navigation -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2 cursor-pointer" onclick="app.goHome()">
                <span class="text-2xl">üáØüáµ</span>
                <h1 class="text-xl font-bold tracking-tight text-stone-900 hidden md:block">Japon <span class="text-indigo-600 font-light">Slow Travel</span></h1>
                <h1 class="text-xl font-bold tracking-tight text-stone-900 md:hidden">Japon <span class="text-indigo-600 font-light">Ultimate</span></h1>
            </div>
            <nav class="flex gap-4 text-sm font-medium text-stone-500 overflow-x-auto">
                <button onclick="app.goHome()" class="whitespace-nowrap hover:text-indigo-600 transition-colors">Vue d'ensemble</button>
                <button onclick="app.filterByRegion('all')" class="whitespace-nowrap hover:text-indigo-600 transition-colors">Explorer les 50+ Lieux</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8 min-h-screen">
        
        <!-- DASHBOARD VIEW -->
        <div id="dashboard-view" class="space-y-12 animate-fade-in">
            
            <!-- Intro -->
            <section class="text-center max-w-4xl mx-auto space-y-6">
                <h2 class="text-3xl md:text-5xl font-bold text-stone-900">Le Grand Tour</h2>
                <p class="text-lg text-stone-600 leading-relaxed">
                    Vous avez identifi√© <strong id="total-count-hero" class="text-indigo-600">0</strong> lieux d'exception. 
                    De la p√©ninsule isol√©e de Tsugaru au nord jusqu'aux for√™ts de Yakushima au sud, cet itin√©raire couvre tout le spectre du Japon.
                    Pour rendre ce voyage r√©alisable, nous avons organis√© vos √©tapes autour de <span class="text-indigo-600 font-bold">Villes Hubs</span> cl√©s.
                </p>
                <div class="flex flex-wrap justify-center gap-3 text-xs md:text-sm text-stone-500 font-mono">
                    <span class="px-3 py-1 bg-white border border-stone-200 rounded-full">üöÖ JR Pass 21 Jours Recommand√©</span>
                    <span class="px-3 py-1 bg-white border border-stone-200 rounded-full">üéí Densit√© : √âlev√©e</span>
                    <span class="px-3 py-1 bg-white border border-stone-200 rounded-full">üå∏ Saison Id√©ale : Printemps/Automne</span>
                </div>
            </section>

            <!-- Global Stats -->
            <section class="bg-white rounded-2xl p-6 shadow-sm border border-stone-100">
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="text-xl font-bold mb-4 text-stone-800 border-l-4 border-indigo-500 pl-3">ADN de votre Voyage</h3>
                        <p class="text-stone-600 mb-6 text-sm">
                            Votre liste est incroyablement compl√®te. Elle combine les classiques urbains (Tokyo/Kyoto) avec des p√©pites rares (Motonosumi, Takayama Inari).
                            Le graphique montre une forte tendance vers le spirituel (Temples/Sanctuaires) et la nature.
                        </p>
                        <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                            <div class="bg-indigo-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-indigo-600" id="stat-total-spots">0</div>
                                <div class="text-[10px] text-indigo-800 uppercase tracking-wide">Lieux</div>
                            </div>
                            <div class="bg-emerald-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-emerald-600" id="stat-nature-percent">0%</div>
                                <div class="text-[10px] text-emerald-800 uppercase tracking-wide">Nature</div>
                            </div>
                            <div class="bg-amber-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-amber-600" id="stat-culture-percent">0%</div>
                                <div class="text-[10px] text-amber-800 uppercase tracking-wide">Culture</div>
                            </div>
                            <div class="bg-rose-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-rose-600" id="stat-regions-count">0</div>
                                <div class="text-[10px] text-rose-800 uppercase tracking-wide">R√©gions</div>
                            </div>
                        </div>
                    </div>
                    <!-- Chart Container -->
                    <div class="chart-container">
                        <canvas id="overviewChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Regions Grid -->
            <section id="regions-section">
                <h3 class="text-xl font-bold mb-6 text-stone-800 border-l-4 border-indigo-500 pl-3">Vos Zones d'Exploration</h3>
                <p class="text-stone-600 mb-6 max-w-2xl text-sm">Cliquez sur une r√©gion pour voir le d√©tail logistique et les activit√©s.</p>
                <div id="regions-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    <!-- Cards injected via JS -->
                </div>
            </section>
        </div>

        <!-- REGION DETAIL VIEW -->
        <div id="region-view" class="hidden space-y-8 animate-fade-in">
            
            <!-- Breadcrumbs -->
            <button onclick="app.goHome()" class="flex items-center text-sm text-stone-500 hover:text-indigo-600 transition-colors mb-4 group font-medium">
                <span class="group-hover:-translate-x-1 transition-transform mr-1">‚Üê</span> Retour Carte Globale
            </button>

            <!-- Hub Header -->
            <div id="hub-header" class="bg-gradient-to-br from-stone-900 to-stone-800 text-white rounded-2xl p-6 md:p-10 shadow-xl relative overflow-hidden">
                <div class="relative z-10">
                    <div class="flex flex-wrap items-center gap-3 mb-4">
                        <span class="inline-block py-1 px-3 rounded bg-white/10 border border-white/20 text-white text-xs font-bold tracking-wider backdrop-blur-sm">R√âGION</span>
                        <span id="region-tag" class="text-stone-300 text-xs bg-black/30 px-2 py-1 rounded"></span>
                    </div>
                    <h2 id="region-title" class="text-3xl md:text-5xl font-bold mb-4 tracking-tight">Region Name</h2>
                    
                    <div class="flex flex-col md:flex-row gap-4 md:gap-8 mt-6">
                        <div class="bg-indigo-600/20 border border-indigo-500/30 p-4 rounded-lg backdrop-blur-md">
                            <p class="text-indigo-200 text-xs uppercase font-bold mb-1">Hub Principal</p>
                            <p id="hub-city" class="text-white text-xl font-semibold">City Name</p>
                        </div>
                        <div class="md:flex-1">
                            <p id="region-desc" class="text-stone-300 text-sm md:text-base leading-relaxed opacity-90">Description...</p>
                        </div>
                    </div>
                </div>
                <!-- Abstract Art -->
                <div class="absolute right-0 top-0 w-96 h-96 bg-indigo-500 rounded-full blur-[100px] opacity-20 mix-blend-screen pointer-events-none"></div>
            </div>

            <!-- Logistics Chart Section -->
            <div class="bg-white rounded-2xl p-6 shadow-sm border border-stone-100">
                <div class="flex flex-col lg:flex-row gap-8">
                    <div class="lg:w-1/3 flex flex-col justify-center">
                        <h3 class="text-lg font-bold mb-2 text-stone-800">‚è±Ô∏è Radar Logistique</h3>
                        <p class="text-sm text-stone-600 mb-4">
                            Temps de transport (aller simple) depuis <span class="font-bold text-indigo-600 hub-name-span"></span>.
                            <br><span class="text-xs text-stone-400 italic">Bas√© sur les trajets Train/Bus standards.</span>
                        </p>
                        <div class="grid grid-cols-3 gap-2 text-center text-[10px] font-bold text-stone-500 mb-4 lg:mb-0">
                            <div class="bg-emerald-50 p-2 rounded border border-emerald-100 text-emerald-700">
                                PROCHE<br>&lt; 60m
                            </div>
                            <div class="bg-amber-50 p-2 rounded border border-amber-100 text-amber-700">
                                MOYEN<br>1h-2h
                            </div>
                            <div class="bg-rose-50 p-2 rounded border border-rose-100 text-rose-700">
                                LOIN<br>&gt; 2h
                            </div>
                        </div>
                    </div>
                    <div class="lg:w-2/3 border-t lg:border-t-0 lg:border-l border-stone-100 pt-4 lg:pt-0 lg:pl-8">
                        <div class="chart-container">
                            <canvas id="logisticsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Activities List -->
            <div>
                <h3 class="text-xl font-bold mb-6 text-stone-800 flex items-center gap-2">
                    <span>üìç</span> Liste des Activit√©s
                </h3>
                <div id="activities-list" class="grid grid-cols-1 xl:grid-cols-2 gap-4">
                    <!-- Activity Cards Injected via JS -->
                </div>
            </div>

        </div>

    </main>

    <footer class="bg-stone-900 text-stone-400 py-8 mt-12 border-t border-stone-800">
        <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-4">
            <p class="text-sm">G√©n√©r√© avec Canvas &bull; 50+ Lieux Trait√©s</p>
            <div class="flex gap-4 text-xl opacity-50">
                <span>‚õ©Ô∏è</span><span>üöÖ</span><span>üóª</span>
            </div>
        </div>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA INGESTION & PROCESSING ---
        // I have manually parsed and enriched the 50+ locations from your list.
        // Logic: Group by Region -> Define Hub -> Estimate Logisitics.

        const rawData = [
            // --- KANTO (Tokyo Hub) ---
            { name: "Shinjuku", region: "Tokyo & Kanto", hub: "Tokyo", type: "Ville/Shopping", rating: 4.5, transport: "M√©tro/JR local", time: 0, desc: "Le c≈ìur battant de Tokyo. N√©ons, foules, Godzilla head et vie nocturne." },
            { name: "Akihabara", region: "Tokyo & Kanto", hub: "Tokyo", type: "Ville/Geek", rating: 4.3, transport: "JR Yamanote (15 min)", time: 15, desc: "La mecque de l'√©lectronique et des otaku. Maids caf√©s et figurines partout." },
            { name: "Ueno", region: "Tokyo & Kanto", hub: "Tokyo", type: "Culture/Parc", rating: 4.4, transport: "JR Yamanote (20 min)", time: 20, desc: "Grands mus√©es nationaux, zoo, et le march√© populaire d'Ameyoko." },
            { name: "Ikebukuro", region: "Tokyo & Kanto", hub: "Tokyo", type: "Ville/Shopping", rating: 4.2, transport: "JR Yamanote (25 min)", time: 25, desc: "Alternative √† Shinjuku/Akiba. Centre Pok√©mon et Sunshine City." },
            { name: "Kamakura (Ville)", region: "Tokyo & Kanto", hub: "Tokyo", type: "Culture/Temples", rating: 4.6, transport: "JR Yokosuka Line (1h)", time: 60, desc: "Le grand Bouddha et les temples zen. Ambiance c√¥ti√®re d√©tendue." },
            { name: "Kamakurak≈çk≈ç-Mae St.", region: "Tokyo & Kanto", hub: "Tokyo", type: "Photo/Anime", rating: 4.3, transport: "Enoden Line (1h15)", time: 75, desc: "Le passage √† niveau l√©gendaire du g√©n√©rique de Slam Dunk. Vue sur mer." },
            { name: "Katori (Chiba)", region: "Tokyo & Kanto", hub: "Tokyo", type: "Culture/Tradition", rating: 4.4, transport: "JR Narita+Kashima (1h40)", time: 100, desc: "La 'Petite Edo' de Chiba. Canaux historiques et grand sanctuaire Katori-jingu." },
            
            // --- FUJI FIVE LAKES (Fuji Hub) ---
            { name: "Parc Oishi", region: "Mont Fuji", hub: "Kawaguchiko", type: "Nature/Vue", rating: 4.5, transport: "Bus touristique (20min)", time: 20, desc: "La vue classique du Fuji avec le lac et les fleurs au premier plan." },
            { name: "Chureito Pagoda", region: "Mont Fuji", hub: "Kawaguchiko", type: "Vue/Ic√¥ne", rating: 4.7, transport: "Train + Marche (30min)", time: 30, desc: "Arakurayama Sengen Park. LA photo du Japon : Pagode + Cerisiers + Fuji." },

            // --- KANSAI CENTRAL (Kyoto Hub) ---
            { name: "Gion", region: "Kyoto", hub: "Kyoto", type: "Culture/Ville", rating: 4.5, transport: "Bus/Marche", time: 15, desc: "Le quartier des Geishas. Rues pav√©es, maisons de th√© et charme ancien." },
            { name: "Ninna-ji", region: "Kyoto", hub: "Kyoto", type: "Temple/UNESCO", rating: 4.6, transport: "Bus/Train Randen (30min)", time: 30, desc: "Immense complexe, c√©l√®bre pour ses cerisiers tardifs Omuro." },
            { name: "Renge-ji", region: "Kyoto", hub: "Kyoto", type: "Temple/Jardin", rating: 4.7, transport: "Bus/Train Eizan (40min)", time: 40, desc: "Un petit joyau cach√© au nord. Jardin sublime, calme absolu." },
            { name: "Kurama-dera", region: "Kyoto", hub: "Kyoto", type: "Montagne/Rando", rating: 4.6, transport: "Train Eizan (50min)", time: 50, desc: "Temple de montagne mystique, terre des Tengu. Rando vers Kibune possible." },
            { name: "Kifune Shrine", region: "Kyoto", hub: "Kyoto", type: "Sanctuaire/Eau", rating: 4.5, transport: "Train Eizan + Bus (1h)", time: 60, desc: "C√©l√®bre pour ses lanternes rouges longeant l'escalier de pierre." },
            { name: "Otagi Nenbutsuji", region: "Kyoto", hub: "Kyoto", type: "Temple/Art", rating: 4.8, transport: "Bus vers Arashiyama (1h)", time: 60, desc: "Le temple aux 1200 statues de pierre aux visages amusants. Tr√®s photog√©nique." },
            { name: "Hozugawa Boat Ride", region: "Kyoto", hub: "Kyoto", type: "Activit√©/Nature", rating: 4.4, transport: "Train vers Kameoka (30min)", time: 30, desc: "Descente de rivi√®re traditionnelle en bateau vers Arashiyama." },
            { name: "Nintendo Museum", region: "Kyoto", hub: "Kyoto", type: "Mus√©e/Geek", rating: 4.9, transport: "Train Kintetsu (20min)", time: 20, desc: "√Ä Uji. Le nouveau mus√©e officiel retra√ßant l'histoire de Nintendo." },
            { name: "Momiji-ya (Takao)", region: "Kyoto", hub: "Kyoto", type: "Restaurant/Rivi√®re", rating: 4.4, transport: "Bus JR (50min)", time: 50, desc: "D√Æner Kawadoko sur la rivi√®re en √©t√©, ou √©rables en automne √† Takao." },

            // --- KANSAI (Osaka/Nara Hubs) ---
            { name: "USJ (Universal)", region: "Osaka & Nara", hub: "Osaka", type: "Parc", rating: 4.8, transport: "JR Loop Line (20min)", time: 20, desc: "Super Nintendo World et Harry Potter. Incontournable mais bond√©." },
            { name: "Wakayama City", region: "Osaka & Nara", hub: "Osaka", type: "Ville", rating: 4.0, transport: "JR Hanwa (1h)", time: 60, desc: "Acc√®s au ch√¢teau et porte d'entr√©e de la r√©gion de Koyasan." },
            { name: "Kasuga-taisha", region: "Osaka & Nara", hub: "Nara (ou Osaka)", type: "Culture", rating: 4.6, transport: "Bus/Marche (local)", time: 15, desc: "Sanctuaire aux lanternes dans le parc de Nara." },
            { name: "Wakakusayama", region: "Osaka & Nara", hub: "Nara (ou Osaka)", type: "Nature/Vue", rating: 4.5, transport: "Marche depuis parc (30min)", time: 30, desc: "Colline herbeuse offrant une vue panoramique sur Nara." },
            { name: "≈åmihachiman", region: "Osaka & Nara", hub: "Kyoto/Osaka", type: "Ville/Canaux", rating: 4.4, transport: "JR Line (40min)", time: 40, desc: "Ville marchande historique au bord du lac Biwa. Balade en bateau." },

            // --- KYOTO MER (North) ---
            { name: "Amanohashidate", region: "Kyoto Nord (Mer)", hub: "Miyazu/Kinosaki", type: "Nature/Vue", rating: 4.4, transport: "Train (Local)", time: 15, desc: "Le 'Pont vers le Ciel'. Une des 3 plus belles vues du Japon." },
            { name: "Ine Fishing Village", region: "Kyoto Nord (Mer)", hub: "Miyazu/Kinosaki", type: "Village/Unique", rating: 4.6, transport: "Bus depuis Amanohashidate (1h)", time: 60, desc: "Les Funaya (maisons-bateaux). Un des plus beaux villages du Japon." },

            // --- CHUGOKU (Hiroshima Hub) ---
            { name: "Itsukushima (√éle)", region: "Hiroshima & Miyajima", hub: "Hiroshima", type: "√éle/Sacr√©", rating: 4.7, transport: "Train + Ferry (50min)", time: 50, desc: "L'√Æle sacr√©e de Miyajima. Cerfs, temples et √©rables." },
            { name: "Itsukushima-jinja", region: "Hiroshima & Miyajima", hub: "Hiroshima", type: "Sanctuaire", rating: 4.6, transport: "Sur place", time: 50, desc: "Le fameux Torii flottant dans la mer." },
            { name: "Daish≈ç-in", region: "Hiroshima & Miyajima", hub: "Hiroshima", type: "Temple", rating: 4.7, transport: "Marche (15min)", time: 65, desc: "Temple bouddhiste magnifique au pied du mont Misen. Souvent oubli√© des foules." },
            { name: "Senj≈çkaku", region: "Hiroshima & Miyajima", hub: "Hiroshima", type: "Histoire", rating: 4.4, transport: "Marche (5min)", time: 55, desc: "Le pavillon aux 1000 tatamis. Une structure en bois impressionnante." },
            { name: "Momijidani Park", region: "Hiroshima & Miyajima", hub: "Hiroshima", type: "Nature", rating: 4.5, transport: "Marche (10min)", time: 60, desc: "Le parc des √©rables. Sublime en automne." },
            { name: "Etajima", region: "Hiroshima & Miyajima", hub: "Hiroshima", type: "√éle/V√©lo", rating: 4.2, transport: "Ferry (30min)", time: 30, desc: "√éle dans la baie d'Hiroshima, calme, parfaite pour le cyclisme." },

            // --- YAMAGUCHI (Shin-Yamaguchi Hub) ---
            { name: "Rurik≈ç-ji", region: "Yamaguchi", hub: "Shin-Yamaguchi", type: "Temple", rating: 4.6, transport: "Bus (30min)", time: 30, desc: "Pagode √† 5 √©tages, tr√©sor national, dans un parc superbe." },
            { name: "Akiyoshido Cave", region: "Yamaguchi", hub: "Shin-Yamaguchi", type: "Nature/Grotte", rating: 4.6, transport: "Bus (45min)", time: 45, desc: "La plus grande grotte calcaire du Japon. Impressionnant." },
            { name: "Beppu Benten Pond", region: "Yamaguchi", hub: "Shin-Yamaguchi", type: "Nature", rating: 4.4, transport: "Train/Taxi (1h)", time: 60, desc: "Un √©tang d'une eau bleu cobalt irr√©elle." },
            { name: "Motonosumi Shrine", region: "Yamaguchi", hub: "Shin-Yamaguchi", type: "Photo/Vue", rating: 4.5, transport: "Train + Taxi (1h30)", time: 90, desc: "123 Torii rouges qui serpentent vers la mer. Difficile d'acc√®s mais iconique." },
            { name: "Mori Clan Burial", region: "Yamaguchi", hub: "Shin-Yamaguchi", type: "Histoire", rating: 4.5, transport: "Train vers Hagi (1h30)", time: 90, desc: "√Ä Hagi. Temple Tokoji. Lanternes de pierre mystiques dans la for√™t." },
            { name: "Shuhoinarimiya", region: "Yamaguchi", hub: "Shin-Yamaguchi", type: "Sanctuaire", rating: 4.0, transport: "Proche Akiyoshido", time: 50, desc: "Petit sanctuaire pr√®s de la grotte." },

            // --- KYUSHU (Nagasaki & Kumamoto Hubs) ---
            { name: "Unzen Jigoku", region: "Ky≈´sh≈´ (Nord)", hub: "Nagasaki", type: "Volcan", rating: 4.5, transport: "Bus (1h40)", time: 100, desc: "Champs de fumerolles volcaniques actifs." },
            { name: "Shimabara Yusui-kan", region: "Ky≈´sh≈´ (Nord)", hub: "Nagasaki", type: "Ville", rating: 4.2, transport: "Train (1h30)", time: 90, desc: "La ville des carpes nageant dans les canaux." },
            { name: "Takachiho Gorge", region: "Ky≈´sh≈´ (Centre)", hub: "Kumamoto/Aso", type: "Nature/Mythe", rating: 4.7, transport: "Bus (2h30)", time: 150, desc: "Gorges volcaniques avec chute d'eau. Barque possible (tr√®s pris√©)." },
            { name: "Amanoiwato-jinja", region: "Ky≈´sh≈´ (Centre)", hub: "Kumamoto/Aso", type: "Mythe", rating: 4.5, transport: "Bus depuis Gorge (20min)", time: 170, desc: "La grotte o√π la d√©esse du soleil Amaterasu s'est cach√©e." },
            { name: "Kusasenrigahama", region: "Ky≈´sh≈´ (Centre)", hub: "Kumamoto/Aso", type: "Nature/Volcan", rating: 4.6, transport: "Bus vers Aso (1h)", time: 60, desc: "Vaste prairie verdoyante au pied du volcan fumant Mont Aso." },
            { name: "Kamishikimi Kumano", region: "Ky≈´sh≈´ (Centre)", hub: "Kumamoto/Aso", type: "Sanctuaire/Anime", rating: 4.8, transport: "Train+Taxi (1h30)", time: 90, desc: "Sanctuaire dans la for√™t. D√©cor du film 'Hotarubi no Mori e'." },

            // --- YAKUSHIMA ---
            { name: "Kokemusu Forest", region: "Yakushima", hub: "Miyanoura", type: "Nature", rating: 4.8, transport: "Bus+Rando", time: 60, desc: "For√™t de mousse primaire. Inspiration Ghibli." },

            // --- ALPES & CHUBU ---
            { name: "Togakushi Shrine", region: "Alpes Japonaises", hub: "Nagano", type: "Montagne", rating: 4.6, transport: "Bus (1h)", time: 60, desc: "All√©e de c√®dres g√©ants et sanctuaire ninja." },
            { name: "Jigokudani Park", region: "Alpes Japonaises", hub: "Nagano", type: "Nature/Singes", rating: 4.5, transport: "Bus (50min)", time: 50, desc: "Les singes des neiges se baignant dans les sources chaudes." },
            { name: "Kamik≈çchi", region: "Alpes Japonaises", hub: "Matsumoto", type: "Rando/Alpes", rating: 4.8, transport: "Train+Bus (1h30)", time: 90, desc: "Vall√©e alpine spectaculaire. Ferm√© en hiver." },
            { name: "Shirakawa-g≈ç", region: "Alpes Japonaises", hub: "Kanazawa/Takayama", type: "Village", rating: 4.6, transport: "Bus (1h15)", time: 75, desc: "Villages aux toits de chaume class√©s UNESCO." },
            { name: "Kanazawa (Ville)", region: "Alpes Japonaises", hub: "Kanazawa", type: "Ville", rating: 4.5, transport: "Local", time: 0, desc: "Jardin Kenroku-en, quartier des samoura√Øs et g√©ishas." },
            { name: "Gifu (Ville)", region: "Alpes Japonaises", hub: "Nagoya/Gifu", type: "Ville", rating: 4.0, transport: "Train", time: 0, desc: "Ch√¢teau de Gifu et p√™che au cormoran." },

            // --- TOHOKU (Nord) ---
            { name: "Takayama Inari", region: "Tohoku (Aomori)", hub: "Hirosaki/Aomori", type: "Sanctuaire", rating: 4.6, transport: "Train+Taxi (1h30)", time: 90, desc: "Jardin japonais et torii rouges. Tr√®s isol√© tout au nord." },

            // --- ONSEN / DIVERS ---
            { name: "Takaragawa Onsen", region: "Gunma (Onsen)", hub: "Minakami", type: "Onsen", rating: 4.4, transport: "Navette (30min)", time: 30, desc: "Immense rotenburo mixte le long de la rivi√®re." },
            { name: "Amagisou (Izu)", region: "Izu Peninsula", hub: "Atami/Ito", type: "Onsen", rating: 4.2, transport: "Bus (1h)", time: 60, desc: "Onsen pr√®s des chutes de Kawazu Nanadaru." },
            { name: "Nachi Falls", region: "Wakayama (Sud)", hub: "Kii-Katsuura", type: "Nature", rating: 4.6, transport: "Bus (30min)", time: 30, desc: "La chute d'eau sacr√©e de Kumano Kodo." }
        ];

        // --- REGIONS CONFIGURATION ---
        const regionsData = {
            "Tokyo & Kanto": { desc: "M√©galopole et escapades historiques.", hub: "Tokyo", color: "indigo" },
            "Mont Fuji": { desc: "La r√©gion des 5 lacs au pied du mont sacr√©.", hub: "Kawaguchiko", color: "sky" },
            "Kyoto": { desc: "L'ancienne capitale imp√©riale. Temples et jardins.", hub: "Kyoto", color: "violet" },
            "Osaka & Nara": { desc: "Divertissement urbain et cerfs sacr√©s.", hub: "Osaka", color: "amber" },
            "Kyoto Nord (Mer)": { desc: "Le Japon c√¥t√© mer, loin des foules.", hub: "Miyazu", color: "teal" },
            "Hiroshima & Miyajima": { desc: "Histoire tragique et √Æle des dieux.", hub: "Hiroshima", color: "rose" },
            "Yamaguchi": { desc: "Grottes et sanctuaires spectaculaires de l'ouest.", hub: "Shin-Yamaguchi", color: "orange" },
            "Ky≈´sh≈´ (Nord)": { desc: "Volcans et histoire chr√©tienne.", hub: "Nagasaki", color: "red" },
            "Ky≈´sh≈´ (Centre)": { desc: "Terres de mythes et de volcans actifs.", hub: "Kumamoto", color: "emerald" },
            "Yakushima": { desc: "√éle sauvage et for√™ts mill√©naires.", hub: "Miyanoura", color: "green" },
            "Alpes Japonaises": { desc: "Le toit du Japon. Neige et traditions.", hub: "Nagano/Kanazawa", color: "slate" },
            "Tohoku (Aomori)": { desc: "Le grand Nord. Sauvage et authentique.", hub: "Hirosaki", color: "cyan" },
            "Gunma (Onsen)": { desc: "La culture du bain en montagne.", hub: "Minakami", color: "stone" },
            "Izu Peninsula": { desc: "Sources chaudes et cascades.", hub: "Atami", color: "lime" },
            "Wakayama (Sud)": { desc: "P√®lerinage sacr√© de Kumano.", hub: "Kii-Katsuura", color: "fuchsia" }
        };

        // --- APP LOGIC ---
        const app = {
            currentView: 'dashboard',
            
            init() {
                this.renderDashboard();
                this.renderOverviewChart();
            },

            goHome() {
                document.getElementById('dashboard-view').classList.remove('hidden');
                document.getElementById('region-view').classList.add('hidden');
                window.scrollTo(0, 0);
            },

            filterByRegion(region) {
                document.getElementById('regions-section').scrollIntoView({ behavior: 'smooth' });
            },

            selectRegion(regionName) {
                document.getElementById('dashboard-view').classList.add('hidden');
                document.getElementById('region-view').classList.remove('hidden');
                this.renderRegionDetail(regionName);
                window.scrollTo(0, 0);
            },

            renderDashboard() {
                document.getElementById('total-count-hero').innerText = rawData.length;
                document.getElementById('stat-total-spots').innerText = rawData.length;
                document.getElementById('stat-regions-count').innerText = Object.keys(regionsData).length;

                // Calc percentages
                const nature = rawData.filter(i => /nature|rando|volcan|montagne|jardin|vue|√Æle/i.test(i.type)).length;
                const culture = rawData.filter(i => /temple|sanctuaire|ville|histoire|mus√©e/i.test(i.type)).length;
                
                document.getElementById('stat-nature-percent').innerText = Math.round((nature/rawData.length)*100) + "%";
                document.getElementById('stat-culture-percent').innerText = Math.round((culture/rawData.length)*100) + "%";

                // Grid
                const grid = document.getElementById('regions-grid');
                grid.innerHTML = '';
                
                const regionCounts = {};
                rawData.forEach(r => regionCounts[r.region] = (regionCounts[r.region]||0)+1);

                Object.keys(regionsData).forEach(rName => {
                    const rData = regionsData[rName];
                    const count = regionCounts[rName] || 0;
                    if(count === 0) return;

                    const el = document.createElement('div');
                    el.className = `bg-white p-5 rounded-xl border border-stone-100 shadow-sm hover:shadow-md hover:border-${rData.color}-300 cursor-pointer transition-all group`;
                    el.onclick = () => this.selectRegion(rName);
                    el.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-bold text-stone-800 text-lg group-hover:text-${rData.color}-600 transition-colors">${rName}</h4>
                            <span class="bg-stone-100 text-stone-500 text-xs font-bold px-2 py-1 rounded">${count}</span>
                        </div>
                        <p class="text-xs text-stone-500 mb-3 line-clamp-2 min-h-[2.5em]">${rData.desc}</p>
                        <div class="text-xs font-medium text-stone-400 flex items-center">
                            <span class="mr-1">üìç</span> Hub: ${rData.hub}
                        </div>
                    `;
                    grid.appendChild(el);
                });
            },

            renderRegionDetail(rName) {
                const rData = regionsData[rName];
                const spots = rawData.filter(i => i.region === rName);

                document.getElementById('region-title').innerText = rName;
                document.getElementById('region-desc').innerText = rData.desc;
                document.getElementById('hub-city').innerText = rData.hub;
                document.getElementById('region-tag').innerText = `${spots.length} Lieux`;
                
                document.querySelectorAll('.hub-name-span').forEach(e => e.innerText = rData.hub);

                // Styling logic for header (simple gradient swap could go here, sticking to dark theme for consistency)

                const list = document.getElementById('activities-list');
                list.innerHTML = '';

                spots.forEach(spot => {
                    const el = document.createElement('div');
                    el.className = "bg-white border border-stone-100 rounded-lg p-4 flex gap-4 hover:border-indigo-200 transition-colors";
                    el.innerHTML = `
                        <div class="flex-shrink-0 w-12 h-12 bg-stone-50 rounded-full flex items-center justify-center text-2xl">
                            ${this.getEmoji(spot.type)}
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-start">
                                <h4 class="font-bold text-stone-800 truncate pr-2">${spot.name}</h4>
                                <span class="text-xs font-bold text-amber-500 flex items-center bg-amber-50 px-1.5 py-0.5 rounded">‚òÖ ${spot.rating}</span>
                            </div>
                            <p class="text-xs text-stone-500 mt-1 mb-2 line-clamp-2 leading-relaxed">${spot.desc}</p>
                            <div class="flex flex-wrap gap-2 text-[10px] font-medium uppercase tracking-wide text-stone-400">
                                <span class="bg-stone-50 px-2 py-1 rounded">‚è± ${spot.time} min</span>
                                <span class="bg-stone-50 px-2 py-1 rounded">üöå ${spot.transport}</span>
                            </div>
                        </div>
                    `;
                    list.appendChild(el);
                });

                this.renderChart(spots);
            },

            getEmoji(type) {
                if(/nature|jardin/i.test(type)) return 'üåø';
                if(/temple|sanctuaire/i.test(type)) return '‚õ©Ô∏è';
                if(/ville|shopping/i.test(type)) return 'üèôÔ∏è';
                if(/eau|volcan|onsen/i.test(type)) return 'üåä';
                if(/histoire|mus√©e/i.test(type)) return 'üìú';
                return 'üìç';
            },

            renderOverviewChart() {
                const ctx = document.getElementById('overviewChart').getContext('2d');
                // Distribution by Region
                const counts = {};
                rawData.forEach(r => counts[r.region] = (counts[r.region]||0)+1);
                
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(counts),
                        datasets: [{
                            data: Object.values(counts),
                            backgroundColor: [
                                '#4f46e5', '#0ea5e9', '#8b5cf6', '#f59e0b', '#14b8a6', 
                                '#f43f5e', '#f97316', '#ef4444', '#10b981', '#22c55e',
                                '#64748b', '#06b6d4', '#78716c', '#84cc16', '#d946ef'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        cutout: '70%'
                    }
                });
            },

            renderChart(spots) {
                const ctx = document.getElementById('logisticsChart').getContext('2d');
                const sorted = [...spots].sort((a,b) => a.time - b.time);
                
                // Destroy old if exists (simple implementation usually requires tracking chart instance)
                if(window.myBarChart) window.myBarChart.destroy();

                window.myBarChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: sorted.map(s => s.name.substring(0, 15) + (s.name.length>15?'...':'')),
                        datasets: [{
                            label: 'Temps (min)',
                            data: sorted.map(s => s.time),
                            backgroundColor: sorted.map(s => s.time <= 60 ? '#10b981' : s.time <= 120 ? '#f59e0b' : '#f43f5e'),
                            borderRadius: 4
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: { x: { beginAtZero: true } }
                    }
                });
            }
        };

        app.init();
    </script>
</body>
</html>